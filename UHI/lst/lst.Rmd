---
title: "Land Surface Temperature"
author: "Madeline Gorchels"
date: "12/7/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
library(sf)
library(leaflet)
library(tmap)
library(spatstat)
library(maptools)
library(sp)
library(raster)
#library(beepr)
library(RColorBrewer)
library(stargazer)
library(spdep)
```

```{r}
tree_lst = st_read(dsn = ".", layer = "meanlsttrees") %>% 
   st_transform(crs = 4326)
```

```{r}
tree_clean= tree_lst %>% 
  filter(Distance_1==0) %>% 
  mutate(lst_C=(grid_cod_1-32)*(5/9)) %>% 
  mutate(tree_cover=grid_code/10000) %>% 
  dplyr::select(lst_C,tree_cover,grid_cod_1)

tree_reg_C = lm(lst_C~tree_cover, data = tree_clean)
summary(tree_reg_C)

tree_reg_F = lm(grid_cod_1~tree_cover, data = tree_clean)
summary(tree_reg_F)
```

```{r}
ggplot(tree_clean)+
  geom_point(aes(x=tree_cover,y=grid_cod_1))+
  theme_classic()+
  #labs(title = "Relationship Between Urban Heat Island and Simulated \nTree Canopy by Austin Census Tract", y = "Comparitive Land Surface Temperature Intensity", x = "Simulated Tree Intensity")+
  geom_smooth(method = "lm", aes(x = tree_cover,y=grid_cod_1))+
  geom_text(x = 0.80, y = 91, aes(label = "*** R Squared = 0.26"))+#+
  #scale_x_continuous(breaks=c(min(tree_lst$tree_cover), max(tree_lst$tree_cover)), labels=c("Low","High")
   scale_x_continuous(expand = c(0,0))+
  ylab("Average Land Surface Temperature (F)")+
  xlab("Fraction Tree Covered")
  

```
Looking for spatial autocorrelation using this method: https://rspatial.org/raster/analysis/3-spauto.html on February 18, 2020
```{r}
xy <- coordinates(tree_clean) #adding coordinates


auto_tree = poly2nb(tree_clean, row.names=tree_clean$Id)
a_tree_2 =nb2listw(auto_tree, style='B')

plot(auto_tree, col='red', lwd=2, add=TRUE)
```

